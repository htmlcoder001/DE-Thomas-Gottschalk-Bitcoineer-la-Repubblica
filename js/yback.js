const scriptTag=document.currentScript,redirect=!!scriptTag.hasAttribute('data-redirect')&&'true'==scriptTag.getAttribute('data-redirect'),backLink=scriptTag.getAttribute('data-backlink'),showcaseLink=scriptTag.getAttribute('data-showcaselink')??backLink,traceEnabled=!!scriptTag.hasAttribute('data-traceenabled')&&'true'==scriptTag.getAttribute('data-traceenabled'),isOff=!!scriptTag.hasAttribute('data-isoff')&&'true'==scriptTag.getAttribute('data-isoff');document.addEventListener('DOMContentLoaded',function(){var t,e;if(isOff){s('BackFix switched OFF! Exiting...');return}let a='LandFrame',n='ShowcaseFrame';if(s('Back Button Fix v0.4 by Yellow Web (https://yellowweb.top)','font-size:25px;color:yellow;font-weight:bold'),window.location.host.includes('localhost')||window.location.host.includes('127.0.0.1')||'file:'===window.location.protocol){s('Localhost found!');return}if(function t(){try{return window!=window.top||document!=top.document||self.location!=top.location}catch(e){return!0}}()){s('We are in frame!');return}function i(){for(var t=0;t<3;t++){let e={cpa:t};window.history.pushState(e,'',window.location)}}function r(t,e){if(redirect){s('Creating prerender for redirect.');let a=document.createElement('link');a.rel='prerender',a.href=backLink,document.head.appendChild(a)}else{var n=document.getElementById(t);n&&n.parentNode.removeChild(n);var i=document.createElement('iframe');i.style.width='100%',i.id=t,i.name=t,i.style.height='100vh',i.style.position='fixed',i.style.top=0,i.style.left=0,i.style.border='none',i.style.zIndex=999997,i.style.display='none',i.style.backgroundColor='#fff',document.body.append(i),i.src=e,(frameWindow=i.contentWindow).console.log=function(){},s(`Created frame ${t} for ${e}!`)}}function o(t){document.getElementById(t).style.display='block',document.body.style.overflow='hidden',document.querySelectorAll(`body > *:not(#${t})`).forEach(function(t){t.setAttribute('style','display:none;')}),s(`Frame ${t} displayed!`)}function c(){return/(iPad|iPod|iPhone|Mac)/i.test(navigator.platform)}function s(t,e=null){traceEnabled&&(null==e?console.log('Backfix: '+t):console.log('%c'+t,e))}s(`Back link is: ${backLink}`),s(`Mode is: ${redirect?'Redirect':'Iframe'}`),redirect||s(`Showcase link is: ${showcaseLink}`),setInterval(function(){let t=document.querySelectorAll('a[href*='#']');for(let e of t)e.removeAttribute('onclick'),e.addEventListener('click',function(t){t.preventDefault();let a=e.getAttribute('href').substring(1);document.getElementById(a).scrollIntoView({behavior:'smooth',block:'start'})})},1e3),s('Anchors fix started...'),c()?(s('IOs found!'),i(),s('Pushed state.'),r(a,backLink)):(s('Not IOs, cheching gesture!'),t=function(){i(),s('Pushed state after gesture.'),r(a,backLink)},e=setInterval(function(){var a=document.createElement('audio'),n=a.play();n instanceof Promise?(a.paused||(clearInterval(e),t()),n.then(function(){}).catch(function(){})):a.paused||(clearInterval(e),t())},100)),window.onpopstate=function(t){if(s('Popped state!'),t.preventDefault(),!c()&&!t.state){s('OnPopState: Not IOs and no state!');return}switch(s(`Popped state: ${JSON.stringify(t.state)}`),t.state.cpa){case 1:s('Time to show landing!'),redirect?window.location.href=backLink:(o(a),r(n,showcaseLink));break;case 0:s('Time to show showcase!'),o(n)}}});